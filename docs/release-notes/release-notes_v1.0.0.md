# Release Notes - v1.0.0

リリース日: 2025-12-24  
タグ: `v1.0.0`

---

## 🎉 概要

Markdown（UTF-8）を読み取り、Excel（.xlsx）に整形出力するツール **md2excel** の初回リリースです。  
見出し／箇条書き／番号付きリスト／引用／コードブロック／テーブルを、Excel シート上で読みやすい体裁に変換します。

---

## ✨ 追加（Features）

- Markdown → Excel（.xlsx）変換の基本機能
  - 出力シート名: `spec`
  - 逐次読み込み（`Files.lines(...).iterator()`）による処理

- 見出し対応
  - `#` / `##` / `###` / `####+` をスタイル分けして出力

- 箇条書き／番号付きリスト対応
  - `* ` 箇条書き（先頭に `・ ` を付与して出力）
  - `1. ` 形式の番号付きリスト（簡易パーサで判定）
  - インデントに応じたネスト（列シフト）対応

- 引用ブロック対応
  - `>` の引用をブロックとして描画（左罫線＋背景）
  - 連続引用の同一セル追記（条件成立時）

- コードブロック対応
  - フェンス ``` に対応
  - 背景色＋外枠罫線でコードブロックとして描画
  - 英数字は `Consolas`、日本語は `Meiryo` に切り替えて表示

- テーブル対応
  - `| a | b |` 形式をテーブルとして出力
  - ヘッダ行／区切り行（`|---|---|`）のスタイル適用
  - エスケープ `\|` を `|` に復元
  - `` `...` `` 内の `|` は区切りにしない安全設計

- インライン装飾対応（セル内リッチテキスト）
  - 太字 `**bold**`
  - インラインコード `` `code` ``（赤文字、等幅、CJK/ASCII でフォント分離）
  - Workbook 単位のフォントキャッシュで生成コストを抑制

- `<br>` 対応
  - インラインコード外の `<br>` を改行として扱い、縦方向に展開
  - 行末 `<br>` による「次行への継続」を見出し／引用／リスト／通常文でサポート
  - 太字継続などのフォーマット維持のため carry を保持

- GUI 設定モード（引数なし実行）
  - Markdown ファイル選択（`JFileChooser`）
  - 1行分として扱う列数（mergeCols）の入力
  - フォント選択、縦位置（上／中央／下）の選択
  - 見出し／通常のフォントサイズ入力

- CLI 設定モード（引数あり実行）
  - `input.md [output.xlsx] [mergeCols] [fontName]`

---

## 🛠 改善（Improvements）

- ブロック境界処理を `MdBlockBoundary` に集約し、処理順序（ORDER）を明確化
- 直前行の状態を `RenderState` に集約し、見出し後の自動空行挿入などの挙動を安定化
- リッチテキスト追記時に `XSSFRichTextString` をクローンして安全に追記（共有参照の破壊を回避）

---

## ⚠️ 既知の制限（Known Limitations）

- 箇条書きは `* ` のみ対応（`- ` / `+ ` は非対応）
- 斜体・取り消し線・リンク等のインライン Markdown は未対応（太字とインラインコードのみ）
- コードブロックは ``` フェンスのみ対応（チルダ等は非対応）
- GUI（Swing）を使用するため、headless 環境ではそのまま実行できない場合があります  
  （完了ダイアログ `JOptionPane` を含む）

---

## 📦 依存関係（Dependencies）

- Java 8+
- Apache POI（XSSF / `XSSFWorkbook`）

---

## ✅ 互換性

- 入力: UTF-8 の Markdown テキスト
- 出力: Excel `.xlsx`（XSSF）

---

## 🙏 謝辞

初回リリースをご利用いただきありがとうございます。  
不具合報告・改善提案は GitHub Issues でお待ちしています。

---
